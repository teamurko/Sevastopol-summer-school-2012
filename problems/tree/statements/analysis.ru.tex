Решается за $O(n \log^2(n))$. В каждой вершине храним set, при слиянии
множеств меньшее добавляем в большее.
