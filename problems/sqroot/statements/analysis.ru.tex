См. разбор задачи <<Корень $n$-ой степени>>.

Если не использовать хэш-мэп,
то можно решать задачу в оффлайне, а именно:
считаем все тесты, сгруппируем их в группы по
одинаковому модулю, так как модуль небольшой,
то можно выбрать $m$ поменьше, тогда второе множество
элементов вида $ab^l$ будет поменьше. Общая сложность
алгоритма $O(MAX_MOD^2/m + NUM_TESTS \cdot m)$.
